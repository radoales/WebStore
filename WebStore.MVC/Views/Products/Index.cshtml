@model IEnumerable<ListProductRequestModel>

@{
    ViewData["Title"] = "Browse Products";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h1>Browse Products</h1>
<form>
    <input id="searchString" asp-action="Index" name="searchString" class="form-control searchString" type="text" placeholder="Type a search word" />
</form>


@if (this.User.IsInRole(Roles.AdminRole))
{
    <p>
        <a asp-action="Create">Add New Product</a>
    </p>
}

@foreach (var item in Model)
{
    <div class="list-gallery list-galery-zoom">
        <a asp-controller="Products" asp-action="Details" asp-route-id="@item.Id">
            <img src="data:image/jpeg;base64,@Convert.ToBase64String(item.Image)" />
            <div class="list-galery-text"> @Html.DisplayFor(modelItem => item.Name)</div>
            <div class="list-galery-text"> @Html.DisplayFor(modelItem => item.Price)</div>
        </a>
        <div class="list-galery-text"><a asp-controller="Cart" asp-action="AddToCart" asp-route-productId="@item.Id">Add to Cart</a></div>
    </div>
}


<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<link rel="stylesheet" href="/resources/demos/style.css">
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script>
    $(".searchString").change(function () {
        $(this).closest('form').submit();
    });

    $(document).ready(function () {
        $.ajax({
            type: "GET",
            url: "/Products/GetAllProductNames",
            contentType: "application/json; charset=utf-8",
            success: function (response) {
                $("#searchString").keyup(function (e) {
                    $("#searchString").autocomplete({
                        source: response
                    });
                });
            },
            failure: function (response) {
                alert(response.responseText);
            },
            error: function (response) {
                alert(response.responseText);
            }
        });
    });

</script>

